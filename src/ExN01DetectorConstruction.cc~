
#include "ExN01DetectorConstruction.hh"

#include "G4Material.hh"
#include "G4Box.hh"
#include "G4Tubs.hh"
#include "G4LogicalVolume.hh"
#include "G4ThreeVector.hh"
#include "G4PVPlacement.hh"
#include "globals.hh"
#include "G4SystemOfUnits.hh"
#include "G4UnionSolid.hh"
#include "G4Colour.hh"
#include "G4VisAttributes.hh"

ExN01DetectorConstruction::ExN01DetectorConstruction()
 :  experimentalHall_log(0), tracker_log(0),
    calorimeterBlock_log(0), calorimeterLayer_log(0),
    experimentalHall_phys(0), calorimeterLayer_phys(0),
    calorimeterBlock_phys(0), tracker_phys(0)
{;}

ExN01DetectorConstruction::~ExN01DetectorConstruction()
{
}

G4VPhysicalVolume* ExN01DetectorConstruction::Construct()
{

  //------------------------------------------------------ materials

  G4double a;  // atomic mass
  G4double z;  // atomic number
  G4double density;
  G4int nel;

  G4Material* Ar = 
  new G4Material("ArgonGas", z= 18., a= 39.95*g/mole, density= 1.782*mg/cm3);

  G4Material* Al = 
  new G4Material("Aluminum", z= 13., a= 26.98*g/mole, density= 2.7*g/cm3);

  G4Material* Pb = 
  new G4Material("Lead", z= 82., a= 207.19*g/mole, density= 11.35*g/cm3);

  G4Element* N = new G4Element("Nitrogen", "N", z=7., a= 14.01*g/mole);
  G4Element* O = new G4Element("Oxygen", "O", z=8., a= 16.00*g/mole);

  G4Material* Vacuum = new G4Material("Vacuum", density= 1.37e-7*kg/m3, nel=2);
  Vacuum->AddElement(N, 70*perCent);
  Vacuum->AddElement(O, 30*perCent);

  //------------------------------------------------------ volumes

  //------------------------------ experimental hall (world volume)
  //------------------------------ beam line along x axis

  G4double expHall_x = 1.0*m;
  G4double expHall_y = 1.0*m;
  G4double expHall_z = 3.0*m;

  G4Box* experimentalHall_box = new G4Box("expHall_box",expHall_x,expHall_y,expHall_z);

  experimentalHall_log = new G4LogicalVolume(experimentalHall_box,Al,"expHall_log",0,0,0);

  experimentalHall_phys = new G4PVPlacement(0,G4ThreeVector(),experimentalHall_log,"expHall",0,false,0);

  //------------------------------ Main Cylinder

   G4double MainCyl_CaseDiam = 30.*mm;
   G4double MainCyl_CaseDepth = 370.*mm;

   G4Tubs* MainCyl = new G4Tubs("MainCyl",0.,MainCyl_CaseDiam/2.,MainCyl_CaseDepth/2.,0.,360.*deg);

   mainCyl_log = new G4LogicalVolume(MainCyl,Al,"MainCyl",0,0,0);

   mainCyl_phys = new G4PVPlacement(0,G4ThreeVector(0,0,71.25*mm+MainCyl_CaseDepth/2.),mainCyl_log,"MainCyl",experimentalHall_log,false,0);

/*
   //------------------------------ Inner Cylinder

   G4double InnerCyl_Diam = 15*mm;
   G4double InnerCyl_Depth = 370*mm;

   G4Tubs* InnerCyl = new G4Tubs("MainCyl",0.,InnerCyl_Diam/2.,InnerCyl_Depth/2.,0.,360.*deg);

   innerCyl_log = new G4LogicalVolume(InnerCyl,Al,"InnerCyl",0,0,0);

   innerCyl_phys = new G4PVPlacement(0,G4ThreeVector(),innerCyl_log,"innerCyl",experimentalHall_log,false,0);
*/

   //------------------------------ Aperture

   G4double Aperture_Width = 2.*mm;
   G4double Aperture_Length = 10.*mm;
   G4double Aperture_Depth = 3.175*mm;
   G4double Aperture_Diam = 2.*mm;
   //stupid setting so you can view arpertures in OGLI, set to 0 for full sim
   G4double Aperture_Offset = 0.02*mm;

   G4ThreeVector Vect(0.,0.,0.);

   G4Tubs* Aperture_Cyl = new G4Tubs("Aperture_Cyl",0.,Aperture_Diam/2.,Aperture_Depth/2.,0.,360.*deg);

   G4Box* Aperture_Box = new G4Box("Aperture_Box",Aperture_Length/2.,Aperture_Width/2.,Aperture_Depth/2.);

   G4UnionSolid* Aperture_Union = new G4UnionSolid("Aperture_Union", Aperture_Box, Aperture_Cyl,0,G4ThreeVector(Aperture_Length/2.+Aperture_Offset,0,0)); 

   G4UnionSolid* Aperture_Union2 = new G4UnionSolid("Aperture_Union2", Aperture_Union, Aperture_Cyl,0,G4ThreeVector(-Aperture_Length/2.-Aperture_Offset,0,0)); 

   G4LogicalVolume* Aperture_log = new G4LogicalVolume(Aperture_Union2,Vacuum,"Aperture_Union2",0,0,0);

   G4VisAttributes * ApertureVisAtt = new G4VisAttributes(G4Colour(1.,0.,0.));
   ApertureVisAtt->SetForceSolid(true);
   Aperture_log->SetVisAttributes(ApertureVisAtt);

   //------------------------------ TubeUpper

   G4double Tube_Diam = 12.*mm;
   G4double Tube_Length = 105.225*mm;

   G4Tubs* TubeUpper_Cyl = new G4Tubs("TubeUpper_Cyl",0.,Tube_Diam/2.,Tube_Length/2.,0.,360.*deg);

   G4LogicalVolume* TubeUpper_log = new G4LogicalVolume(TubeUpper_Cyl,Vacuum,"TubeUpper_Cyl",0,0,0);
   //defualt tube, some others are different

   //----------------------------- TubeLower

   G4double TubeLower_Diam = 15.*mm;
   //the rest is determined on a tube by tube basis

   //------------------------------ Row 0 (phi = 0*deg)

   G4double Origin0_x = 0.;//point on z axis that apertures point to
   G4double Origin0_y = 0.;
   G4double Origin0_z = 200.*mm;

   //----------------0

   G4RotationMatrix* Aperture00_Rot = new G4RotationMatrix();
   G4double Aperture00_theta = 120.*deg;
   G4double Aperture00_phi = 0.*deg;
   Aperture00_Rot->rotateX(Aperture00_theta);

   G4double Aperture00_x = 0.;
   G4double Aperture00_y = 53.336*mm;
   G4double Aperture00_z = 169.206*mm;

//   G4PVPlacement* Aperture00_phys = new G4PVPlacement(Aperture00_Rot,G4ThreeVector(Aperture00_x,Aperture00_y,Aperture00_z),Aperture_log,"Aperture00",experimentalHall_log,false,0);

   G4double TubeUpper00_x = Aperture00_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture00_theta)*sin(Aperture00_phi);
   G4double TubeUpper00_y = Aperture00_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture00_theta)*cos(Aperture00_phi);
   G4double TubeUpper00_z = Aperture00_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture00_theta);

//   G4PVPlacement* TubeUpper00_phys = new G4PVPlacement(Aperture00_Rot,G4ThreeVector(TubeUpper00_x,TubeUpper00_y,TubeUpper00_z),TubeUpper_log,"TubeUpper00",experimentalHall_log,false,0);

   G4VisAttributes * TubeVisAtt = new G4VisAttributes(G4Colour(0.,0.,1.));
   TubeVisAtt->SetForceSolid(true);
   TubeUpper_log->SetVisAttributes(TubeVisAtt);

   G4double TubeLower00_x = (Origin0_x + Aperture00_x - Aperture_Depth/2.*sin(Aperture00_theta)*sin(Aperture00_phi))/2.;
   G4double TubeLower00_y = (Origin0_y + Aperture00_y - Aperture_Depth/2.*sin(Aperture00_theta)*cos(Aperture00_phi))/2.;
   G4double TubeLower00_z = (Origin0_z + Aperture00_z - Aperture_Depth/2.*cos(Aperture00_theta))/2.;

   G4double TubeLower00_Length = pow(pow(Origin0_x-TubeLower00_x,2.)+pow(Origin0_y-TubeLower00_y,2.)+pow(Origin0_z-TubeLower00_z,2.),0.5)*2.;

   G4Tubs* TubeLower00_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower00_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower00_log = new G4LogicalVolume(TubeLower00_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower00_phys = new G4PVPlacement(Aperture00_Rot,G4ThreeVector(TubeLower00_x,TubeLower00_y,TubeLower00_z),TubeLower00_log,"TubeLower00",experimentalHall_log,false,0);

   G4VisAttributes * TubeLowerVisAtt = new G4VisAttributes(G4Colour(0.,1.,0.));
   TubeLowerVisAtt->SetForceSolid(true);
   TubeLower00_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------1

   G4RotationMatrix* Aperture01_Rot = new G4RotationMatrix();
   G4double Aperture01_theta = 75.*deg;
   G4double Aperture01_phi = 0.*deg;
   Aperture01_Rot->rotateX(Aperture01_theta);

   G4double Aperture01_x = 0.;
   G4double Aperture01_y = 59.489*mm;
   G4double Aperture01_z = 215.94*mm;

//   G4PVPlacement* Aperture01_phys = new G4PVPlacement(Aperture01_Rot,G4ThreeVector(Aperture01_x,Aperture01_y,Aperture01_z),Aperture_log,"Aperture01",experimentalHall_log,false,0);

   G4double TubeUpper01_x = Aperture01_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture01_theta)*sin(Aperture01_phi);
   G4double TubeUpper01_y = Aperture01_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture01_theta)*cos(Aperture01_phi);
   G4double TubeUpper01_z = Aperture01_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture01_theta);

//   G4PVPlacement* TubeUpper01_phys = new G4PVPlacement(Aperture01_Rot,G4ThreeVector(TubeUpper01_x,TubeUpper01_y,TubeUpper01_z),TubeUpper_log,"TubeUpper01",experimentalHall_log,false,0);

   G4double TubeLower01_x = (Origin0_x + Aperture01_x - Aperture_Depth/2.*sin(Aperture01_theta)*sin(Aperture01_phi))/2.;
   G4double TubeLower01_y = (Origin0_y + Aperture01_y - Aperture_Depth/2.*sin(Aperture01_theta)*cos(Aperture01_phi))/2.;
   G4double TubeLower01_z = (Origin0_z + Aperture01_z - Aperture_Depth/2.*cos(Aperture01_theta))/2.;

   G4double TubeLower01_Length = pow(pow(Origin0_x-TubeLower01_x,2.)+pow(Origin0_y-TubeLower01_y,2.)+pow(Origin0_z-TubeLower01_z,2.),0.5)*2.;

   G4Tubs* TubeLower01_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower01_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower01_log = new G4LogicalVolume(TubeLower01_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower01_phys = new G4PVPlacement(Aperture01_Rot,G4ThreeVector(TubeLower01_x,TubeLower01_y,TubeLower01_z),TubeLower01_log,"TubeLower01",experimentalHall_log,false,0);

   TubeLower01_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------2

   G4RotationMatrix* Aperture02_Rot = new G4RotationMatrix();
   G4double Aperture02_theta = 55.*deg;
   G4double Aperture02_phi = 0.*deg;
   Aperture02_Rot->rotateX(Aperture02_theta);

   G4double Aperture02_x = 0.;
   G4double Aperture02_y = 50.450*mm;
   G4double Aperture02_z = 235.325*mm;

//   G4PVPlacement* Aperture02_phys = new G4PVPlacement(Aperture02_Rot,G4ThreeVector(Aperture02_x,Aperture02_y,Aperture02_z),Aperture_log,"Aperture02",experimentalHall_log,false,0);

   G4double TubeUpper02_x = Aperture02_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture02_theta)*sin(Aperture02_phi);
   G4double TubeUpper02_y = Aperture02_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture02_theta)*cos(Aperture02_phi);
   G4double TubeUpper02_z = Aperture02_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture02_theta);

//   G4PVPlacement* TubeUpper02_phys = new G4PVPlacement(Aperture02_Rot,G4ThreeVector(TubeUpper02_x,TubeUpper02_y,TubeUpper02_z),TubeUpper_log,"TubeUpper02",experimentalHall_log,false,0);

   G4double TubeLower02_x = (Origin0_x + Aperture02_x - Aperture_Depth/2.*sin(Aperture02_theta)*sin(Aperture02_phi))/2.;
   G4double TubeLower02_y = (Origin0_y + Aperture02_y - Aperture_Depth/2.*sin(Aperture02_theta)*cos(Aperture02_phi))/2.;
   G4double TubeLower02_z = (Origin0_z + Aperture02_z - Aperture_Depth/2.*cos(Aperture02_theta))/2.;

   G4double TubeLower02_Length = pow(pow(Origin0_x-TubeLower02_x,2.)+pow(Origin0_y-TubeLower02_y,2.)+pow(Origin0_z-TubeLower02_z,2.),0.5)*2.;

   G4Tubs* TubeLower02_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower02_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower02_log = new G4LogicalVolume(TubeLower02_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower02_phys = new G4PVPlacement(Aperture02_Rot,G4ThreeVector(TubeLower02_x,TubeLower02_y,TubeLower02_z),TubeLower02_log,"TubeLower02",experimentalHall_log,false,0);

   TubeLower02_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------3

   G4RotationMatrix* Aperture03_Rot = new G4RotationMatrix();
   G4double Aperture03_theta = 35.*deg;
   G4double Aperture03_phi = 0.*deg;
   Aperture03_Rot->rotateX(Aperture03_theta);

   G4double Aperture03_x = 0.;
   G4double Aperture03_y = 35.325*mm;
   G4double Aperture03_z = 250.450*mm;

//   G4PVPlacement* Aperture03_phys = new G4PVPlacement(Aperture03_Rot,G4ThreeVector(Aperture03_x,Aperture03_y,Aperture03_z),Aperture_log,"Aperture03",experimentalHall_log,false,0);

   G4double TubeUpper03_x = Aperture03_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture03_theta)*sin(Aperture03_phi);
   G4double TubeUpper03_y = Aperture03_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture03_theta)*cos(Aperture03_phi);
   G4double TubeUpper03_z = Aperture03_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture03_theta);

//   G4PVPlacement* TubeUpper03_phys = new G4PVPlacement(Aperture03_Rot,G4ThreeVector(TubeUpper03_x,TubeUpper03_y,TubeUpper03_z),TubeUpper_log,"TubeUpper03",experimentalHall_log,false,0);

   G4double TubeLower03_x = (Origin0_x + Aperture03_x - Aperture_Depth/2.*sin(Aperture03_theta)*sin(Aperture03_phi))/2.;
   G4double TubeLower03_y = (Origin0_y + Aperture03_y - Aperture_Depth/2.*sin(Aperture03_theta)*cos(Aperture03_phi))/2.;
   G4double TubeLower03_z = (Origin0_z + Aperture03_z - Aperture_Depth/2.*cos(Aperture03_theta))/2.;

   G4double TubeLower03_Length = pow(pow(Origin0_x-TubeLower03_x,2.)+pow(Origin0_y-TubeLower03_y,2.)+pow(Origin0_z-TubeLower03_z,2.),0.5)*2.;

   G4Tubs* TubeLower03_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower03_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower03_log = new G4LogicalVolume(TubeLower03_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower03_phys = new G4PVPlacement(Aperture03_Rot,G4ThreeVector(TubeLower03_x,TubeLower03_y,TubeLower03_z),TubeLower03_log,"TubeLower03",experimentalHall_log,false,0);

   TubeLower03_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------4

   G4RotationMatrix* Aperture04_Rot = new G4RotationMatrix();
   Aperture04_Rot->rotateX((22.5)*deg);//theta

//   G4PVPlacement* Aperture04_phys = new G4PVPlacement(Aperture04_Rot,G4ThreeVector(0.,35.325*mm,250.450*mm),Aperture_log,"Aperture04",experimentalHall_log,false,0);

   //------------------------------ Row 1 (phi = -40*deg)

   G4double Origin1_x = 0.;
   G4double Origin1_y = 0.;
   G4double Origin1_z = 200.*mm;

   //----------------0

   G4RotationMatrix* Aperture10_Rot = new G4RotationMatrix();
   G4double Aperture10_theta = 135.*deg;
   G4double Aperture10_phi = -40.*deg;
   Aperture10_Rot->rotateZ(Aperture10_phi);
   Aperture10_Rot->rotateX(Aperture10_theta);

   G4double Aperture10_x = -27.993*mm;
   G4double Aperture10_y = 33.360*mm;
   G4double Aperture10_z = 156.451*mm;

   G4ThreeVector Vect10(Aperture10_x,Aperture10_y,Aperture10_z);

//   G4PVPlacement* Aperture10_phys = new G4PVPlacement(Aperture10_Rot,Vect10,Aperture_log,"Aperture10",experimentalHall_log,false,0);

   G4double TubeUpper10_x = (Aperture10_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture10_theta)*sin(Aperture10_phi))*mm;
   G4double TubeUpper10_y = (Aperture10_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture10_theta)*cos(Aperture10_phi))*mm;
   G4double TubeUpper10_z = (Aperture10_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture10_theta))*mm;

   G4ThreeVector TubeVect10(TubeUpper10_x,TubeUpper10_y,TubeUpper10_z);

//   G4PVPlacement* TubeUpper10_phys = new G4PVPlacement(Aperture10_Rot,TubeVect10,TubeUpper_log,"TubeUpper10",experimentalHall_log,false,0);

   G4double TubeLower10_x = (Origin1_x + Aperture10_x - Aperture_Depth/2.*sin(Aperture10_theta)*sin(Aperture10_phi))/2.;
   G4double TubeLower10_y = (Origin1_y + Aperture10_y - Aperture_Depth/2.*sin(Aperture10_theta)*cos(Aperture10_phi))/2.;
   G4double TubeLower10_z = (Origin1_z + Aperture10_z - Aperture_Depth/2.*cos(Aperture10_theta))/2.;

   G4double TubeLower10_Length = pow(pow(Origin1_x-TubeLower10_x,2.)+pow(Origin1_y-TubeLower10_y,2.)+pow(Origin1_z-TubeLower10_z,2.),0.5)*2.;

   G4Tubs* TubeLower10_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower10_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower10_log = new G4LogicalVolume(TubeLower10_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower10_phys = new G4PVPlacement(Aperture10_Rot,G4ThreeVector(TubeLower10_x,TubeLower10_y,TubeLower10_z),TubeLower10_log,"TubeLower10",experimentalHall_log,false,0);

   TubeLower10_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------1

   G4RotationMatrix* Aperture11_Rot = new G4RotationMatrix();
   G4double Aperture11_theta = 65.*deg;
   G4double Aperture11_phi = -40.*deg;
   Aperture11_Rot->rotateZ(Aperture11_phi);
   Aperture11_Rot->rotateX(Aperture11_theta);

   G4double Aperture11_x = -35.879*mm;
   G4double Aperture11_y = 42.758*mm;
   G4double Aperture11_z = 226.028*mm;

   G4ThreeVector Vect11(Aperture11_x,Aperture11_y,Aperture11_z);

//   G4PVPlacement* Aperture11_phys = new G4PVPlacement(Aperture11_Rot,Vect11,Aperture_log,"Aperture11",experimentalHall_log,false,0);

   G4double TubeUpper11_x = (Aperture11_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture11_theta)*sin(Aperture11_phi))*mm;
   G4double TubeUpper11_y = (Aperture11_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture11_theta)*cos(Aperture11_phi))*mm;
   G4double TubeUpper11_z = (Aperture11_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture11_theta))*mm;

   G4ThreeVector TubeVect11(TubeUpper11_x,TubeUpper11_y,TubeUpper11_z);

//   G4PVPlacement* TubeUpper11_phys = new G4PVPlacement(Aperture11_Rot,TubeVect11,TubeUpper_log,"TubeUpper11",experimentalHall_log,false,0);

   G4double TubeLower11_x = (Origin1_x + Aperture11_x - Aperture_Depth/2.*sin(Aperture11_theta)*sin(Aperture11_phi))/2.;
   G4double TubeLower11_y = (Origin1_y + Aperture11_y - Aperture_Depth/2.*sin(Aperture11_theta)*cos(Aperture11_phi))/2.;
   G4double TubeLower11_z = (Origin1_z + Aperture11_z - Aperture_Depth/2.*cos(Aperture11_theta))/2.;

   G4double TubeLower11_Length = pow(pow(Origin1_x-TubeLower11_x,2.)+pow(Origin1_y-TubeLower11_y,2.)+pow(Origin1_z-TubeLower11_z,2.),0.5)*2.;

   G4Tubs* TubeLower11_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower11_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower11_log = new G4LogicalVolume(TubeLower11_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower11_phys = new G4PVPlacement(Aperture11_Rot,G4ThreeVector(TubeLower11_x,TubeLower11_y,TubeLower11_z),TubeLower11_log,"TubeLower11",experimentalHall_log,false,0);

   TubeLower11_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------2

   G4RotationMatrix* Aperture12_Rot = new G4RotationMatrix();
   G4double Aperture12_theta = 45.*deg;
   G4double Aperture12_phi = -40.*deg;
   Aperture12_Rot->rotateZ(Aperture12_phi);
   Aperture12_Rot->rotateX(Aperture12_theta);

   G4double Aperture12_x = -27.993*mm;
   G4double Aperture12_y = 33.360*mm;
   G4double Aperture12_z = 243.549*mm;

   G4ThreeVector Vect12(Aperture12_x,Aperture12_y,Aperture12_z);

//   G4PVPlacement* Aperture12_phys = new G4PVPlacement(Aperture12_Rot,Vect12,Aperture_log,"Aperture12",experimentalHall_log,false,0);

   G4double TubeUpper12_x = (Aperture12_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture12_theta)*sin(Aperture12_phi))*mm;
   G4double TubeUpper12_y = (Aperture12_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture12_theta)*cos(Aperture12_phi))*mm;
   G4double TubeUpper12_z = (Aperture12_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture12_theta))*mm;

   G4ThreeVector TubeVect12(TubeUpper12_x,TubeUpper12_y,TubeUpper12_z);

//   G4PVPlacement* TubeUpper12_phys = new G4PVPlacement(Aperture12_Rot,TubeVect12,TubeUpper_log,"TubeUpper12",experimentalHall_log,false,0);

   G4double TubeLower12_x = (Origin1_x + Aperture12_x - Aperture_Depth/2.*sin(Aperture12_theta)*sin(Aperture12_phi))/2.;
   G4double TubeLower12_y = (Origin1_y + Aperture12_y - Aperture_Depth/2.*sin(Aperture12_theta)*cos(Aperture12_phi))/2.;
   G4double TubeLower12_z = (Origin1_z + Aperture12_z - Aperture_Depth/2.*cos(Aperture12_theta))/2.;

   G4double TubeLower12_Length = pow(pow(Origin1_x-TubeLower12_x,2.)+pow(Origin1_y-TubeLower12_y,2.)+pow(Origin1_z-TubeLower12_z,2.),0.5)*2.;

   G4Tubs* TubeLower12_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower12_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower12_log = new G4LogicalVolume(TubeLower12_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower12_phys = new G4PVPlacement(Aperture12_Rot,G4ThreeVector(TubeLower12_x,TubeLower12_y,TubeLower12_z),TubeLower12_log,"TubeLower12",experimentalHall_log,false,0);

   TubeLower12_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------3

   G4RotationMatrix* Aperture13_Rot = new G4RotationMatrix();
   G4double Aperture13_theta = 30.*deg;
   G4double Aperture13_phi = -40.*deg;
   Aperture13_Rot->rotateZ(Aperture13_phi);
   Aperture13_Rot->rotateX(Aperture13_theta);

   G4double Aperture13_x = -19.794*mm;
   G4double Aperture13_y = 23.589*mm;
   G4double Aperture13_z = 253.336*mm;

   G4ThreeVector Vect13(Aperture13_x,Aperture13_y,Aperture13_z);

//   G4PVPlacement* Aperture13_phys = new G4PVPlacement(Aperture13_Rot,Vect13,Aperture_log,"Aperture13",experimentalHall_log,false,0);

   G4double TubeUpper13_x = (Aperture13_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture13_theta)*sin(Aperture13_phi))*mm;
   G4double TubeUpper13_y = (Aperture13_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture13_theta)*cos(Aperture13_phi))*mm;
   G4double TubeUpper13_z = (Aperture13_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture13_theta))*mm;

   G4ThreeVector TubeVect13(TubeUpper13_x,TubeUpper13_y,TubeUpper13_z);

//   G4PVPlacement* TubeUpper13_phys = new G4PVPlacement(Aperture13_Rot,TubeVect13,TubeUpper_log,"TubeUpper13",experimentalHall_log,false,0);

   G4double TubeLower13_x = (Origin1_x + Aperture13_x - Aperture_Depth/2.*sin(Aperture13_theta)*sin(Aperture13_phi))/2.;
   G4double TubeLower13_y = (Origin1_y + Aperture13_y - Aperture_Depth/2.*sin(Aperture13_theta)*cos(Aperture13_phi))/2.;
   G4double TubeLower13_z = (Origin1_z + Aperture13_z - Aperture_Depth/2.*cos(Aperture13_theta))/2.;

   G4double TubeLower13_Length = pow(pow(Origin1_x-TubeLower13_x,2.)+pow(Origin1_y-TubeLower13_y,2.)+pow(Origin1_z-TubeLower13_z,2.),0.5)*2.;

   G4Tubs* TubeLower13_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower13_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower13_log = new G4LogicalVolume(TubeLower13_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower13_phys = new G4PVPlacement(Aperture13_Rot,G4ThreeVector(TubeLower13_x,TubeLower13_y,TubeLower13_z),TubeLower13_log,"TubeLower13",experimentalHall_log,false,0);

   TubeLower13_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------4

   G4RotationMatrix* Aperture14_Rot = new G4RotationMatrix();
   G4double Aperture14_theta = 20.*deg;
   G4double Aperture14_phi = -40.*deg;
   Aperture14_Rot->rotateZ(Aperture14_phi);//phi
   Aperture14_Rot->rotateX(Aperture14_theta);//theta

   G4double Aperture14_x = -13.540*mm;
   G4double Aperture14_y = 16.136*mm;
   G4double Aperture14_z = 257.873*mm;

   G4ThreeVector Vect14(Aperture14_x,Aperture14_y,Aperture14_z);

//   G4PVPlacement* Aperture14_phys = new G4PVPlacement(Aperture14_Rot,Vect14,Aperture_log,"Aperture14",experimentalHall_log,false,0);

   G4double TubeUpper14_x = (Aperture14_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture14_theta)*sin(Aperture14_phi))*mm;
   G4double TubeUpper14_y = (Aperture14_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture14_theta)*cos(Aperture14_phi))*mm;
   G4double TubeUpper14_z = (Aperture14_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture14_theta))*mm;

   G4ThreeVector TubeVect14(TubeUpper14_x,TubeUpper14_y,TubeUpper14_z);

//   G4PVPlacement* TubeUpper14_phys = new G4PVPlacement(Aperture14_Rot,TubeVect14,TubeUpper_log,"TubeUpper14",experimentalHall_log,false,0);

   G4double TubeLower14_x = (Origin1_x + Aperture14_x - Aperture_Depth/2.*sin(Aperture14_theta)*sin(Aperture14_phi))/2.;
   G4double TubeLower14_y = (Origin1_y + Aperture14_y - Aperture_Depth/2.*sin(Aperture14_theta)*cos(Aperture14_phi))/2.;
   G4double TubeLower14_z = (Origin1_z + Aperture14_z - Aperture_Depth/2.*cos(Aperture14_theta))/2.;

   G4double TubeLower14_Length = pow(pow(Origin1_x-TubeLower14_x,2.)+pow(Origin1_y-TubeLower14_y,2.)+pow(Origin1_z-TubeLower14_z,2.),0.5)*2.;

   G4Tubs* TubeLower14_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower14_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower14_log = new G4LogicalVolume(TubeLower14_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower14_phys = new G4PVPlacement(Aperture14_Rot,G4ThreeVector(TubeLower14_x,TubeLower14_y,TubeLower14_z),TubeLower14_log,"TubeLower14",experimentalHall_log,false,0);

   TubeLower14_log->SetVisAttributes(TubeLowerVisAtt);

   //------------------------------ Row 2 (phi = -80*deg)

   G4double Origin2_x = 0.;
   G4double Origin2_y = 0.;
   G4double Origin2_z = 150.*mm;

   //----------------0

   G4RotationMatrix* Aperture20_Rot = new G4RotationMatrix();
   G4double Aperture20_theta = 60.*deg;
   G4double Aperture20_phi = -80.*deg;
   Aperture20_Rot->rotateZ(Aperture20_phi);
   Aperture20_Rot->rotateX(Aperture20_theta);

   G4double Aperture20_x = -52.526*mm;
   G4double Aperture20_y = 9.262*mm;
   G4double Aperture20_z = 180.794*mm;

   G4ThreeVector Vect20(Aperture20_x,Aperture20_y,Aperture20_z);

//   G4PVPlacement* Aperture20_phys = new G4PVPlacement(Aperture20_Rot,Vect20,Aperture_log,"Aperture20",experimentalHall_log,false,0);

   G4double TubeUpper20_x = (Aperture20_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture20_theta)*sin(Aperture20_phi))*mm;
   G4double TubeUpper20_y = (Aperture20_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture20_theta)*cos(Aperture20_phi))*mm;
   G4double TubeUpper20_z = (Aperture20_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture20_theta))*mm;

   G4ThreeVector TubeVect20(TubeUpper20_x,TubeUpper20_y,TubeUpper20_z);

//   G4PVPlacement* TubeUpper20_phys = new G4PVPlacement(Aperture20_Rot,TubeVect20,TubeUpper_log,"TubeUpper20",experimentalHall_log,false,0);

   G4double TubeLower20_x = (Origin2_x + Aperture20_x - Aperture_Depth/2.*sin(Aperture20_theta)*sin(Aperture20_phi))/2.;
   G4double TubeLower20_y = (Origin2_y + Aperture20_y - Aperture_Depth/2.*sin(Aperture20_theta)*cos(Aperture20_phi))/2.;
   G4double TubeLower20_z = (Origin2_z + Aperture20_z - Aperture_Depth/2.*cos(Aperture20_theta))/2.;

   G4double TubeLower20_Length = pow(pow(Origin2_x-TubeLower20_x,2.)+pow(Origin2_y-TubeLower20_y,2.)+pow(Origin2_z-TubeLower20_z,2.),0.5)*2.;

   G4Tubs* TubeLower20_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower20_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower20_log = new G4LogicalVolume(TubeLower20_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower20_phys = new G4PVPlacement(Aperture20_Rot,G4ThreeVector(TubeLower20_x,TubeLower20_y,TubeLower20_z),TubeLower20_log,"TubeLower20",experimentalHall_log,false,0);

   TubeLower20_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------1

   G4RotationMatrix* Aperture21_Rot = new G4RotationMatrix();
   G4double Aperture21_theta = 40.*deg;
   G4double Aperture21_phi = -80.*deg;
   Aperture21_Rot->rotateZ(Aperture21_phi);//phi
   Aperture21_Rot->rotateX(Aperture21_theta);//theta

   G4double Aperture21_x = -38.986*mm;
   G4double Aperture21_y = 6.874*mm;
   G4double Aperture21_z = 197.176*mm;

   G4ThreeVector Vect21(Aperture21_x,Aperture21_y,Aperture21_z);

//   G4PVPlacement* Aperture21_phys = new G4PVPlacement(Aperture21_Rot,Vect21,Aperture_log,"Aperture21",experimentalHall_log,false,0);

   G4double TubeUpper21_x = (Aperture21_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture21_theta)*sin(Aperture21_phi))*mm;
   G4double TubeUpper21_y = (Aperture21_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture21_theta)*cos(Aperture21_phi))*mm;
   G4double TubeUpper21_z = (Aperture21_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture21_theta))*mm;

   G4ThreeVector TubeVect21(TubeUpper21_x,TubeUpper21_y,TubeUpper21_z);

//   G4PVPlacement* TubeUpper21_phys = new G4PVPlacement(Aperture21_Rot,TubeVect21,TubeUpper_log,"TubeUpper21",experimentalHall_log,false,0);

   G4double TubeLower21_x = (Origin2_x + Aperture21_x - Aperture_Depth/2.*sin(Aperture21_theta)*sin(Aperture21_phi))/2.;
   G4double TubeLower21_y = (Origin2_y + Aperture21_y - Aperture_Depth/2.*sin(Aperture21_theta)*cos(Aperture21_phi))/2.;
   G4double TubeLower21_z = (Origin2_z + Aperture21_z - Aperture_Depth/2.*cos(Aperture21_theta))/2.;

   G4double TubeLower21_Length = pow(pow(Origin2_x-TubeLower21_x,2.)+pow(Origin2_y-TubeLower21_y,2.)+pow(Origin2_z-TubeLower21_z,2.),0.5)*2.;

   G4Tubs* TubeLower21_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower21_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower21_log = new G4LogicalVolume(TubeLower21_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower21_phys = new G4PVPlacement(Aperture21_Rot,G4ThreeVector(TubeLower21_x,TubeLower21_y,TubeLower21_z),TubeLower21_log,"TubeLower21",experimentalHall_log,false,0);

   TubeLower21_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------2

   G4RotationMatrix* Aperture22_Rot = new G4RotationMatrix();
   G4double Aperture22_theta = 25.*deg;
   G4double Aperture22_phi = -80.*deg;
   Aperture22_Rot->rotateZ(Aperture22_phi);//phi
   Aperture22_Rot->rotateX(Aperture22_theta);//theta

   G4double Aperture22_x = -25.633*mm;
   G4double Aperture22_y = 4.520*mm;
   G4double Aperture22_z = 205.817*mm;

   G4ThreeVector Vect22(Aperture22_x,Aperture22_y,Aperture22_z);

//   G4PVPlacement* Aperture22_phys = new G4PVPlacement(Aperture22_Rot,Vect22,Aperture_log,"Aperture22",experimentalHall_log,false,0);

   G4double TubeUpper22_x = (Aperture22_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture22_theta)*sin(Aperture22_phi))*mm;
   G4double TubeUpper22_y = (Aperture22_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture22_theta)*cos(Aperture22_phi))*mm;
   G4double TubeUpper22_z = (Aperture22_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture22_theta))*mm;

   G4ThreeVector TubeVect22(TubeUpper22_x,TubeUpper22_y,TubeUpper22_z);

//   G4PVPlacement* TubeUpper22_phys = new G4PVPlacement(Aperture22_Rot,TubeVect22,TubeUpper_log,"TubeUpper22",experimentalHall_log,false,0);

   G4double TubeLower22_x = (Origin2_x + Aperture22_x - Aperture_Depth/2.*sin(Aperture22_theta)*sin(Aperture22_phi))/2.;
   G4double TubeLower22_y = (Origin2_y + Aperture22_y - Aperture_Depth/2.*sin(Aperture22_theta)*cos(Aperture22_phi))/2.;
   G4double TubeLower22_z = (Origin2_z + Aperture22_z - Aperture_Depth/2.*cos(Aperture22_theta))/2.;

   G4double TubeLower22_Length = pow(pow(Origin2_x-TubeLower22_x,2.)+pow(Origin2_y-TubeLower22_y,2.)+pow(Origin2_z-TubeLower22_z,2.),0.5)*2.;

   G4Tubs* TubeLower22_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower22_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower22_log = new G4LogicalVolume(TubeLower22_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower22_phys = new G4PVPlacement(Aperture22_Rot,G4ThreeVector(TubeLower22_x,TubeLower22_y,TubeLower22_z),TubeLower22_log,"TubeLower22",experimentalHall_log,false,0);

   TubeLower22_log->SetVisAttributes(TubeLowerVisAtt);

   //------------------------------ Row 3 (phi = -120*deg)

   G4double Origin3_x = 0.;
   G4double Origin3_y = 0.;
   G4double Origin3_z = 150.*mm;

   //----------------0

   G4RotationMatrix* Aperture30_Rot = new G4RotationMatrix();
   G4double Aperture30_theta = 55.*deg;
   G4double Aperture30_phi = -120.*deg;
   Aperture30_Rot->rotateZ(Aperture30_phi);//phi
   Aperture30_Rot->rotateX(Aperture30_theta);//theta

   G4double Aperture30_x = -43.691*mm;
   G4double Aperture30_y = -25.225*mm;
   G4double Aperture30_z = 185.325*mm;

   G4ThreeVector Vect30(Aperture30_x,Aperture30_y,Aperture30_z);

//   G4PVPlacement* Aperture30_phys = new G4PVPlacement(Aperture30_Rot,Vect30,Aperture_log,"Aperture30",experimentalHall_log,false,0);

   G4double TubeUpper30_x = (Aperture30_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture30_theta)*sin(Aperture30_phi))*mm;
   G4double TubeUpper30_y = (Aperture30_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture30_theta)*cos(Aperture30_phi))*mm;
   G4double TubeUpper30_z = (Aperture30_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture30_theta))*mm;

   G4ThreeVector TubeVect30(TubeUpper30_x,TubeUpper30_y,TubeUpper30_z);

//   G4PVPlacement* TubeUpper30_phys = new G4PVPlacement(Aperture30_Rot,TubeVect30,TubeUpper_log,"TubeUpper30",experimentalHall_log,false,0);

   G4double TubeLower30_x = (Origin3_x + Aperture30_x - Aperture_Depth/2.*sin(Aperture30_theta)*sin(Aperture30_phi))/2.;
   G4double TubeLower30_y = (Origin3_y + Aperture30_y - Aperture_Depth/2.*sin(Aperture30_theta)*cos(Aperture30_phi))/2.;
   G4double TubeLower30_z = (Origin3_z + Aperture30_z - Aperture_Depth/2.*cos(Aperture30_theta))/2.;

   G4double TubeLower30_Length = pow(pow(Origin3_x-TubeLower30_x,2.)+pow(Origin3_y-TubeLower30_y,2.)+pow(Origin3_z-TubeLower30_z,2.),0.5)*2.;

   G4Tubs* TubeLower30_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower30_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower30_log = new G4LogicalVolume(TubeLower30_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower30_phys = new G4PVPlacement(Aperture30_Rot,G4ThreeVector(TubeLower30_x,TubeLower30_y,TubeLower30_z),TubeLower30_log,"TubeLower30",experimentalHall_log,false,0);

   TubeLower30_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------1

   G4RotationMatrix* Aperture31_Rot = new G4RotationMatrix();
   G4double Aperture31_theta = 35.*deg;
   G4double Aperture31_phi = -120.*deg;
   Aperture31_Rot->rotateZ(Aperture31_phi);//phi
   Aperture31_Rot->rotateX(Aperture31_theta);//theta

   G4double Aperture31_x = -30.592*mm;
   G4double Aperture31_y = -17.663*mm;
   G4double Aperture31_z = 200.450*mm;

   G4ThreeVector Vect31(Aperture31_x,Aperture31_y,Aperture31_z);

//   G4PVPlacement* Aperture31_phys = new G4PVPlacement(Aperture31_Rot,Vect31,Aperture_log,"Aperture31",experimentalHall_log,false,0);

   G4double TubeUpper31_x = (Aperture31_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture31_theta)*sin(Aperture31_phi))*mm;
   G4double TubeUpper31_y = (Aperture31_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture31_theta)*cos(Aperture31_phi))*mm;
   G4double TubeUpper31_z = (Aperture31_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture31_theta))*mm;

   G4ThreeVector TubeVect31(TubeUpper31_x,TubeUpper31_y,TubeUpper31_z);

//   G4PVPlacement* TubeUpper31_phys = new G4PVPlacement(Aperture31_Rot,TubeVect31,TubeUpper_log,"TubeUpper31",experimentalHall_log,false,0);

   G4double TubeLower31_x = (Origin3_x + Aperture31_x - Aperture_Depth/2.*sin(Aperture31_theta)*sin(Aperture31_phi))/2.;
   G4double TubeLower31_y = (Origin3_y + Aperture31_y - Aperture_Depth/2.*sin(Aperture31_theta)*cos(Aperture31_phi))/2.;
   G4double TubeLower31_z = (Origin3_z + Aperture31_z - Aperture_Depth/2.*cos(Aperture31_theta))/2.;

   G4double TubeLower31_Length = pow(pow(Origin3_x-TubeLower31_x,2.)+pow(Origin3_y-TubeLower31_y,2.)+pow(Origin3_z-TubeLower31_z,2.),0.5)*2.;

   G4Tubs* TubeLower31_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower31_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower31_log = new G4LogicalVolume(TubeLower31_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower31_phys = new G4PVPlacement(Aperture31_Rot,G4ThreeVector(TubeLower31_x,TubeLower31_y,TubeLower31_z),TubeLower31_log,"TubeLower31",experimentalHall_log,false,0);

   TubeLower31_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------2

   G4RotationMatrix* Aperture32_Rot = new G4RotationMatrix();
   G4double Aperture32_theta = 22.5*deg;
   G4double Aperture32_phi = -120.*deg;
   Aperture32_Rot->rotateZ(Aperture32_phi);//phi
   Aperture32_Rot->rotateX(Aperture32_theta);//theta

   G4double Aperture32_x = -25.382*mm;
   G4double Aperture32_y = -14.654*mm;
   G4double Aperture32_z = 220.750*mm;

   G4double Tube32_Length = 90.225*mm;

   G4ThreeVector Vect32(Aperture32_x,Aperture32_y,Aperture32_z);

//   G4PVPlacement* Aperture32_phys = new G4PVPlacement(Aperture32_Rot,Vect32,Aperture_log,"Aperture32",experimentalHall_log,false,0);

   G4double TubeUpper32_x = (Aperture32_x + (Aperture_Depth+Tube32_Length)/2.*sin(Aperture32_theta)*sin(Aperture32_phi))*mm;
   G4double TubeUpper32_y = (Aperture32_y + (Aperture_Depth+Tube32_Length)/2.*sin(Aperture32_theta)*cos(Aperture32_phi))*mm;
   G4double TubeUpper32_z = (Aperture32_z + (Aperture_Depth+Tube32_Length)/2.*cos(Aperture32_theta))*mm;

   G4ThreeVector TubeVect32(TubeUpper32_x,TubeUpper32_y,TubeUpper32_z);

   G4Tubs* TubeUpper32_Cyl = new G4Tubs("TubeUpper_Cyl",0.,Tube_Diam/2.,Tube32_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeUpper32_log = new G4LogicalVolume(TubeUpper32_Cyl,Vacuum,"TubeUpper32_Cyl",0,0,0);

//   G4PVPlacement* TubeUpper32_phys = new G4PVPlacement(Aperture32_Rot,TubeVect32,TubeUpper32_log,"TubeUpper32",experimentalHall_log,false,0);

   TubeUpper32_log->SetVisAttributes(TubeVisAtt);

   G4double TubeLower32_x = (Origin3_x + Aperture32_x - Aperture_Depth/2.*sin(Aperture32_theta)*sin(Aperture32_phi))/2.;
   G4double TubeLower32_y = (Origin3_y + Aperture32_y - Aperture_Depth/2.*sin(Aperture32_theta)*cos(Aperture32_phi))/2.;
   G4double TubeLower32_z = (Origin3_z + Aperture32_z - Aperture_Depth/2.*cos(Aperture32_theta))/2.;

   G4double TubeLower32_Length = pow(pow(Origin3_x-TubeLower32_x,2.)+pow(Origin3_y-TubeLower32_y,2.)+pow(Origin3_z-TubeLower32_z,2.),0.5)*2.;

   G4Tubs* TubeLower32_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower32_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower32_log = new G4LogicalVolume(TubeLower32_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower32_phys = new G4PVPlacement(Aperture32_Rot,G4ThreeVector(TubeLower32_x,TubeLower32_y,TubeLower32_z),TubeLower32_log,"TubeLower32",experimentalHall_log,false,0);

   TubeLower32_log->SetVisAttributes(TubeLowerVisAtt);

   //------------------------------ Row 4 (phi = -160*deg)

   G4double Origin4_x = 0.;
   G4double Origin4_y = 0.;
   G4double Origin4_z = 150.*mm;

   //----------------0
   G4RotationMatrix* Aperture40_Rot = new G4RotationMatrix();
   G4double Aperture40_theta = 65.*deg;
   G4double Aperture40_phi = -160.*deg;
   Aperture40_Rot->rotateZ(Aperture40_phi);//phi
   Aperture40_Rot->rotateX(Aperture40_theta);//theta

   G4double Aperture40_x = -19.091*mm;
   G4double Aperture40_y = -52.451*mm;
   G4double Aperture40_z = 176.028*mm;

   G4ThreeVector Vect40(Aperture40_x,Aperture40_y,Aperture40_z);

//   G4PVPlacement* Aperture40_phys = new G4PVPlacement(Aperture40_Rot,Vect40,Aperture_log,"Aperture40",experimentalHall_log,false,0);

   G4double TubeUpper40_x = (Aperture40_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture40_theta)*sin(Aperture40_phi))*mm;
   G4double TubeUpper40_y = (Aperture40_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture40_theta)*cos(Aperture40_phi))*mm;
   G4double TubeUpper40_z = (Aperture40_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture40_theta))*mm;

   G4ThreeVector TubeVect40(TubeUpper40_x,TubeUpper40_y,TubeUpper40_z);

//   G4PVPlacement* TubeUpper40_phys = new G4PVPlacement(Aperture40_Rot,TubeVect40,TubeUpper_log,"TubeUpper40",experimentalHall_log,false,0);

   G4double TubeLower40_x = (Origin4_x + Aperture40_x - Aperture_Depth/2.*sin(Aperture40_theta)*sin(Aperture40_phi))/2.;
   G4double TubeLower40_y = (Origin4_y + Aperture40_y - Aperture_Depth/2.*sin(Aperture40_theta)*cos(Aperture40_phi))/2.;
   G4double TubeLower40_z = (Origin4_z + Aperture40_z - Aperture_Depth/2.*cos(Aperture40_theta))/2.;

   G4double TubeLower40_Length = pow(pow(Origin4_x-TubeLower40_x,2.)+pow(Origin4_y-TubeLower40_y,2.)+pow(Origin4_z-TubeLower40_z,2.),0.5)*2.;

   G4Tubs* TubeLower40_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower40_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower40_log = new G4LogicalVolume(TubeLower40_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower40_phys = new G4PVPlacement(Aperture40_Rot,G4ThreeVector(TubeLower40_x,TubeLower40_y,TubeLower40_z),TubeLower40_log,"TubeLower40",experimentalHall_log,false,0);

   TubeLower40_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------1
   G4RotationMatrix* Aperture41_Rot = new G4RotationMatrix();
   G4double Aperture41_theta = 45.*deg;
   G4double Aperture41_phi = -160.*deg;
   Aperture41_Rot->rotateZ(Aperture41_phi);//phi
   Aperture41_Rot->rotateX(Aperture41_theta);//theta

   G4double Aperture41_x = -14.895*mm;
   G4double Aperture41_y = -40.923*mm;
   G4double Aperture41_z = 193.549*mm;

   G4ThreeVector Vect41(Aperture41_x,Aperture41_y,Aperture41_z);

//   G4PVPlacement* Aperture41_phys = new G4PVPlacement(Aperture41_Rot,Vect41,Aperture_log,"Aperture41",experimentalHall_log,false,0);

   G4double TubeUpper41_x = (Aperture41_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture41_theta)*sin(Aperture41_phi))*mm;
   G4double TubeUpper41_y = (Aperture41_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture41_theta)*cos(Aperture41_phi))*mm;
   G4double TubeUpper41_z = (Aperture41_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture41_theta))*mm;

   G4ThreeVector TubeVect41(TubeUpper41_x,TubeUpper41_y,TubeUpper41_z);

//   G4PVPlacement* TubeUpper41_phys = new G4PVPlacement(Aperture41_Rot,TubeVect41,TubeUpper_log,"TubeUpper41",experimentalHall_log,false,0);

   G4double TubeLower41_x = (Origin4_x + Aperture41_x - Aperture_Depth/2.*sin(Aperture41_theta)*sin(Aperture41_phi))/2.;
   G4double TubeLower41_y = (Origin4_y + Aperture41_y - Aperture_Depth/2.*sin(Aperture41_theta)*cos(Aperture41_phi))/2.;
   G4double TubeLower41_z = (Origin4_z + Aperture41_z - Aperture_Depth/2.*cos(Aperture41_theta))/2.;

   G4double TubeLower41_Length = pow(pow(Origin4_x-TubeLower41_x,2.)+pow(Origin4_y-TubeLower41_y,2.)+pow(Origin4_z-TubeLower41_z,2.),0.5)*2.;

   G4Tubs* TubeLower41_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower41_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower41_log = new G4LogicalVolume(TubeLower41_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower41_phys = new G4PVPlacement(Aperture41_Rot,G4ThreeVector(TubeLower41_x,TubeLower41_y,TubeLower41_z),TubeLower41_log,"TubeLower41",experimentalHall_log,false,0);

   TubeLower41_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------2
   G4RotationMatrix* Aperture42_Rot = new G4RotationMatrix();
   G4double Aperture42_theta = 30.*deg;
   G4double Aperture42_phi = -160.*deg;
   Aperture42_Rot->rotateZ(Aperture42_phi);//phi
   Aperture42_Rot->rotateX(Aperture42_theta);//theta

   G4double Aperture42_x = -10.532*mm;
   G4double Aperture42_y = -28.937*mm;
   G4double Aperture42_z = 203.336*mm;

   G4ThreeVector Vect42(Aperture42_x,Aperture42_y,Aperture42_z);

//   G4PVPlacement* Aperture42_phys = new G4PVPlacement(Aperture42_Rot,Vect42,Aperture_log,"Aperture42",experimentalHall_log,false,0);

   G4double TubeUpper42_x = (Aperture42_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture42_theta)*sin(Aperture42_phi))*mm;
   G4double TubeUpper42_y = (Aperture42_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture42_theta)*cos(Aperture42_phi))*mm;
   G4double TubeUpper42_z = (Aperture42_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture42_theta))*mm;

   G4ThreeVector TubeVect42(TubeUpper42_x,TubeUpper42_y,TubeUpper42_z);

//   G4PVPlacement* TubeUpper42_phys = new G4PVPlacement(Aperture42_Rot,TubeVect42,TubeUpper_log,"TubeUpper42",experimentalHall_log,false,0);

   G4double TubeLower42_x = (Origin4_x + Aperture42_x - Aperture_Depth/2.*sin(Aperture42_theta)*sin(Aperture42_phi))/2.;
   G4double TubeLower42_y = (Origin4_y + Aperture42_y - Aperture_Depth/2.*sin(Aperture42_theta)*cos(Aperture42_phi))/2.;
   G4double TubeLower42_z = (Origin4_z + Aperture42_z - Aperture_Depth/2.*cos(Aperture42_theta))/2.;

   G4double TubeLower42_Length = pow(pow(Origin4_x-TubeLower41_x,2.)+pow(Origin4_y-TubeLower42_y,2.)+pow(Origin4_z-TubeLower42_z,2.),0.5)*2.;

   G4Tubs* TubeLower42_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower42_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower42_log = new G4LogicalVolume(TubeLower42_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower42_phys = new G4PVPlacement(Aperture42_Rot,G4ThreeVector(TubeLower42_x,TubeLower42_y,TubeLower42_z),TubeLower42_log,"TubeLower42",experimentalHall_log,false,0);

   TubeLower42_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------3
   G4RotationMatrix* Aperture43_Rot = new G4RotationMatrix();
   G4double Aperture43_theta = 20.*deg;
   G4double Aperture43_phi = -160.*deg;
   Aperture43_Rot->rotateZ(Aperture43_phi);//phi
   Aperture43_Rot->rotateX(Aperture43_theta);//theta

   G4double Aperture43_x = -7.204*mm;
   G4double Aperture43_y = -19.794*mm;
   G4double Aperture43_z = 207.873*mm;

   G4ThreeVector Vect43(Aperture43_x,Aperture43_y,Aperture43_z);

//   G4PVPlacement* Aperture43_phys = new G4PVPlacement(Aperture43_Rot,Vect43,Aperture_log,"Aperture43",experimentalHall_log,false,0);

   G4double TubeUpper43_x = (Aperture43_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture43_theta)*sin(Aperture43_phi))*mm;
   G4double TubeUpper43_y = (Aperture43_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture43_theta)*cos(Aperture43_phi))*mm;
   G4double TubeUpper43_z = (Aperture43_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture43_theta))*mm;

   G4ThreeVector TubeVect43(TubeUpper43_x,TubeUpper43_y,TubeUpper43_z);

//   G4PVPlacement* TubeUpper43_phys = new G4PVPlacement(Aperture43_Rot,TubeVect43,TubeUpper_log,"TubeUpper43",experimentalHall_log,false,0);

   G4double TubeLower43_x = (Origin4_x + Aperture43_x - Aperture_Depth/2.*sin(Aperture43_theta)*sin(Aperture43_phi))/2.;
   G4double TubeLower43_y = (Origin4_y + Aperture43_y - Aperture_Depth/2.*sin(Aperture43_theta)*cos(Aperture43_phi))/2.;
   G4double TubeLower43_z = (Origin4_z + Aperture43_z - Aperture_Depth/2.*cos(Aperture43_theta))/2.;

   G4double TubeLower43_Length = pow(pow(Origin4_x-TubeLower43_x,2.)+pow(Origin4_y-TubeLower43_y,2.)+pow(Origin4_z-TubeLower43_z,2.),0.5)*2.;

   G4Tubs* TubeLower43_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower43_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower43_log = new G4LogicalVolume(TubeLower43_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower43_phys = new G4PVPlacement(Aperture43_Rot,G4ThreeVector(TubeLower43_x,TubeLower43_y,TubeLower43_z),TubeLower43_log,"TubeLower43",experimentalHall_log,false,0);

   TubeLower43_log->SetVisAttributes(TubeLowerVisAtt);

   //------------------------------ Row 5 (phi = 160*deg)

   G4double Origin5_x = 0.;
   G4double Origin5_y = 0.;
   G4double Origin5_z = 100.*mm;

   //----------------0
   G4RotationMatrix* Aperture50_Rot = new G4RotationMatrix();
   G4double Aperture50_theta = 60.*deg;
   G4double Aperture50_phi = 160.*deg;
   Aperture50_Rot->rotateZ(Aperture50_phi);//phi
   Aperture50_Rot->rotateX(Aperture50_theta);//theta

   G4double Aperture50_x = 18.242*mm;
   G4double Aperture50_y = -50.120*mm;
   G4double Aperture50_z = 130.794*mm;

   G4ThreeVector Vect50(Aperture50_x,Aperture50_y,Aperture50_z);

//   G4PVPlacement* Aperture50_phys = new G4PVPlacement(Aperture50_Rot,Vect50,Aperture_log,"Aperture50",experimentalHall_log,false,0);

   G4double TubeUpper50_x = (Aperture50_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture50_theta)*sin(Aperture50_phi))*mm;
   G4double TubeUpper50_y = (Aperture50_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture50_theta)*cos(Aperture50_phi))*mm;
   G4double TubeUpper50_z = (Aperture50_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture50_theta))*mm;

   G4ThreeVector TubeVect50(TubeUpper50_x,TubeUpper50_y,TubeUpper50_z);

//   G4PVPlacement* TubeUpper50_phys = new G4PVPlacement(Aperture50_Rot,TubeVect50,TubeUpper_log,"TubeUpper50",experimentalHall_log,false,0);

   G4double TubeLower50_x = (Origin5_x + Aperture50_x - Aperture_Depth/2.*sin(Aperture50_theta)*sin(Aperture50_phi))/2.;
   G4double TubeLower50_y = (Origin5_y + Aperture50_y - Aperture_Depth/2.*sin(Aperture50_theta)*cos(Aperture50_phi))/2.;
   G4double TubeLower50_z = (Origin5_z + Aperture50_z - Aperture_Depth/2.*cos(Aperture50_theta))/2.;

   G4double TubeLower50_Length = pow(pow(Origin5_x-TubeLower50_x,2.)+pow(Origin5_y-TubeLower50_y,2.)+pow(Origin5_z-TubeLower50_z,2.),0.5)*2.;

   G4Tubs* TubeLower50_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower50_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower50_log = new G4LogicalVolume(TubeLower50_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower50_phys = new G4PVPlacement(Aperture50_Rot,G4ThreeVector(TubeLower50_x,TubeLower50_y,TubeLower50_z),TubeLower50_log,"TubeLower50",experimentalHall_log,false,0);

   TubeLower50_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------1
   G4RotationMatrix* Aperture51_Rot = new G4RotationMatrix();
   G4double Aperture51_theta = 40.*deg;
   G4double Aperture51_phi = 160.*deg;
   Aperture51_Rot->rotateZ(Aperture51_phi);//phi
   Aperture51_Rot->rotateX(Aperture51_theta);//theta

   G4double Aperture51_x = 13.540*mm;
   G4double Aperture51_y = -37.200*mm;
   G4double Aperture51_z = 147.179*mm;

   G4ThreeVector Vect51(Aperture51_x,Aperture51_y,Aperture51_z);

//   G4PVPlacement* Aperture51_phys = new G4PVPlacement(Aperture51_Rot,Vect51,Aperture_log,"Aperture51",experimentalHall_log,false,0);

   G4double TubeUpper51_x = (Aperture51_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture51_theta)*sin(Aperture51_phi))*mm;
   G4double TubeUpper51_y = (Aperture51_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture51_theta)*cos(Aperture51_phi))*mm;
   G4double TubeUpper51_z = (Aperture51_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture51_theta))*mm;

   G4ThreeVector TubeVect51(TubeUpper51_x,TubeUpper51_y,TubeUpper51_z);

//   G4PVPlacement* TubeUpper51_phys = new G4PVPlacement(Aperture51_Rot,TubeVect51,TubeUpper_log,"TubeUpper51",experimentalHall_log,false,0);

   G4double TubeLower51_x = (Origin5_x + Aperture51_x - Aperture_Depth/2.*sin(Aperture51_theta)*sin(Aperture51_phi))/2.;
   G4double TubeLower51_y = (Origin5_y + Aperture51_y - Aperture_Depth/2.*sin(Aperture51_theta)*cos(Aperture51_phi))/2.;
   G4double TubeLower51_z = (Origin5_z + Aperture51_z - Aperture_Depth/2.*cos(Aperture51_theta))/2.;

   G4double TubeLower51_Length = pow(pow(Origin5_x-TubeLower51_x,2.)+pow(Origin5_y-TubeLower51_y,2.)+pow(Origin5_z-TubeLower51_z,2.),0.5)*2.;

   G4Tubs* TubeLower51_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower51_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower51_log = new G4LogicalVolume(TubeLower51_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower51_phys = new G4PVPlacement(Aperture51_Rot,G4ThreeVector(TubeLower51_x,TubeLower51_y,TubeLower51_z),TubeLower51_log,"TubeLower51",experimentalHall_log,false,0);

   TubeLower51_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------2
   G4RotationMatrix* Aperture52_Rot = new G4RotationMatrix();
   G4double Aperture52_theta = 25.*deg;
   G4double Aperture52_phi = 160.*deg;
   Aperture52_Rot->rotateZ(Aperture52_phi);//phi
   Aperture52_Rot->rotateX(Aperture52_theta);//theta

   G4double Aperture52_x = 8.902*mm;
   G4double Aperture52_y = -24.458*mm;
   G4double Aperture52_z = 155.817*mm;

   G4ThreeVector Vect52(Aperture52_x,Aperture52_y,Aperture52_z);

//   G4PVPlacement* Aperture52_phys = new G4PVPlacement(Aperture52_Rot,Vect52,Aperture_log,"Aperture52",experimentalHall_log,false,0);

   G4double TubeUpper52_x = (Aperture52_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture52_theta)*sin(Aperture52_phi))*mm;
   G4double TubeUpper52_y = (Aperture52_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture52_theta)*cos(Aperture52_phi))*mm;
   G4double TubeUpper52_z = (Aperture52_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture52_theta))*mm;

   G4ThreeVector TubeVect52(TubeUpper52_x,TubeUpper52_y,TubeUpper52_z);

//   G4PVPlacement* TubeUpper52_phys = new G4PVPlacement(Aperture52_Rot,TubeVect52,TubeUpper_log,"TubeUpper52",experimentalHall_log,false,0);

   G4double TubeLower52_x = (Origin5_x + Aperture52_x - Aperture_Depth/2.*sin(Aperture52_theta)*sin(Aperture52_phi))/2.;
   G4double TubeLower52_y = (Origin5_y + Aperture52_y - Aperture_Depth/2.*sin(Aperture52_theta)*cos(Aperture52_phi))/2.;
   G4double TubeLower52_z = (Origin5_z + Aperture52_z - Aperture_Depth/2.*cos(Aperture52_theta))/2.;

   G4double TubeLower52_Length = pow(pow(Origin5_x-TubeLower52_x,2.)+pow(Origin5_y-TubeLower52_y,2.)+pow(Origin5_z-TubeLower52_z,2.),0.5)*2.;

   G4Tubs* TubeLower52_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower52_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower52_log = new G4LogicalVolume(TubeLower52_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower52_phys = new G4PVPlacement(Aperture52_Rot,G4ThreeVector(TubeLower52_x,TubeLower52_y,TubeLower52_z),TubeLower52_log,"TubeLower52",experimentalHall_log,false,0);

   TubeLower52_log->SetVisAttributes(TubeLowerVisAtt);

   //------------------------------ Row 6 (phi = 120*deg)

   G4double Origin6_x = 0.;
   G4double Origin6_y = 0.;
   G4double Origin6_z = 100.*mm;

   //----------------0
   G4RotationMatrix* Aperture60_Rot = new G4RotationMatrix();
   G4double Aperture60_theta = 55.*deg;
   G4double Aperture60_phi = 120.*deg;
   Aperture60_Rot->rotateZ(Aperture60_phi);//phi
   Aperture60_Rot->rotateX(Aperture60_theta);//theta

   G4double Aperture60_x = 43.691*mm;
   G4double Aperture60_y = -25.225*mm;
   G4double Aperture60_z = 135.325*mm;

   G4ThreeVector Vect60(Aperture60_x,Aperture60_y,Aperture60_z);

//   G4PVPlacement* Aperture60_phys = new G4PVPlacement(Aperture60_Rot,Vect60,Aperture_log,"Aperture60",experimentalHall_log,false,0);

   G4double TubeUpper60_x = (Aperture60_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture60_theta)*sin(Aperture60_phi))*mm;
   G4double TubeUpper60_y = (Aperture60_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture60_theta)*cos(Aperture60_phi))*mm;
   G4double TubeUpper60_z = (Aperture60_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture60_theta))*mm;

   G4ThreeVector TubeVect60(TubeUpper60_x,TubeUpper60_y,TubeUpper60_z);

//   G4PVPlacement* TubeUpper60_phys = new G4PVPlacement(Aperture60_Rot,TubeVect60,TubeUpper_log,"TubeUpper60",experimentalHall_log,false,0);

   G4double TubeLower60_x = (Origin6_x + Aperture60_x - Aperture_Depth/2.*sin(Aperture60_theta)*sin(Aperture60_phi))/2.;
   G4double TubeLower60_y = (Origin6_y + Aperture60_y - Aperture_Depth/2.*sin(Aperture60_theta)*cos(Aperture60_phi))/2.;
   G4double TubeLower60_z = (Origin6_z + Aperture60_z - Aperture_Depth/2.*cos(Aperture60_theta))/2.;

   G4double TubeLower60_Length = pow(pow(Origin6_x-TubeLower60_x,2.)+pow(Origin6_y-TubeLower60_y,2.)+pow(Origin6_z-TubeLower60_z,2.),0.5)*2.;

   G4Tubs* TubeLower60_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower60_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower60_log = new G4LogicalVolume(TubeLower60_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower60_phys = new G4PVPlacement(Aperture60_Rot,G4ThreeVector(TubeLower60_x,TubeLower60_y,TubeLower60_z),TubeLower60_log,"TubeLower60",experimentalHall_log,false,0);

   TubeLower60_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------1
   G4RotationMatrix* Aperture61_Rot = new G4RotationMatrix();
   G4double Aperture61_theta = 35.*deg;
   G4double Aperture61_phi = 120.*deg;
   Aperture61_Rot->rotateZ(Aperture61_phi);//phi
   Aperture61_Rot->rotateX(Aperture61_theta);//theta

   G4double Aperture61_x = 30.592*mm;
   G4double Aperture61_y = -17.663*mm;
   G4double Aperture61_z = 150.450*mm;

   G4ThreeVector Vect61(Aperture61_x,Aperture61_y,Aperture61_z);

//   G4PVPlacement* Aperture61_phys = new G4PVPlacement(Aperture61_Rot,Vect61,Aperture_log,"Aperture61",experimentalHall_log,false,0);

   G4double TubeUpper61_x = (Aperture61_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture61_theta)*sin(Aperture61_phi))*mm;
   G4double TubeUpper61_y = (Aperture61_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture61_theta)*cos(Aperture61_phi))*mm;
   G4double TubeUpper61_z = (Aperture61_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture61_theta))*mm;

   G4ThreeVector TubeVect61(TubeUpper61_x,TubeUpper61_y,TubeUpper61_z);

//   G4PVPlacement* TubeUpper61_phys = new G4PVPlacement(Aperture61_Rot,TubeVect61,TubeUpper_log,"TubeUpper61",experimentalHall_log,false,0);

   G4double TubeLower61_x = (Origin6_x + Aperture61_x - Aperture_Depth/2.*sin(Aperture61_theta)*sin(Aperture61_phi))/2.;
   G4double TubeLower61_y = (Origin6_y + Aperture61_y - Aperture_Depth/2.*sin(Aperture61_theta)*cos(Aperture61_phi))/2.;
   G4double TubeLower61_z = (Origin6_z + Aperture61_z - Aperture_Depth/2.*cos(Aperture61_theta))/2.;

   G4double TubeLower61_Length = pow(pow(Origin6_x-TubeLower61_x,2.)+pow(Origin6_y-TubeLower61_y,2.)+pow(Origin6_z-TubeLower61_z,2.),0.5)*2.;

   G4Tubs* TubeLower61_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower61_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower61_log = new G4LogicalVolume(TubeLower61_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower61_phys = new G4PVPlacement(Aperture61_Rot,G4ThreeVector(TubeLower61_x,TubeLower61_y,TubeLower61_z),TubeLower61_log,"TubeLower61",experimentalHall_log,false,0);

   TubeLower61_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------2
   G4RotationMatrix* Aperture62_Rot = new G4RotationMatrix();
   G4double Aperture62_theta = 22.5*deg;
   G4double Aperture62_phi = 120.*deg;
   Aperture62_Rot->rotateZ(Aperture62_phi);//phi
   Aperture62_Rot->rotateX(Aperture62_theta);//theta

   G4double Aperture62_x = 20.411*mm;
   G4double Aperture62_y = -11.784*mm;
   G4double Aperture62_z = 156.899*mm;

   G4ThreeVector Vect62(Aperture62_x,Aperture62_y,Aperture62_z);

//   G4PVPlacement* Aperture62_phys = new G4PVPlacement(Aperture62_Rot,Vect62,Aperture_log,"Aperture62",experimentalHall_log,false,0);

   G4double TubeUpper62_x = (Aperture62_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture62_theta)*sin(Aperture62_phi))*mm;
   G4double TubeUpper62_y = (Aperture62_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture62_theta)*cos(Aperture62_phi))*mm;
   G4double TubeUpper62_z = (Aperture62_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture62_theta))*mm;

   G4ThreeVector TubeVect62(TubeUpper62_x,TubeUpper62_y,TubeUpper62_z);

//   G4PVPlacement* TubeUpper62_phys = new G4PVPlacement(Aperture62_Rot,TubeVect62,TubeUpper_log,"TubeUpper62",experimentalHall_log,false,0);

   G4double TubeLower62_x = (Origin6_x + Aperture62_x - Aperture_Depth/2.*sin(Aperture62_theta)*sin(Aperture62_phi))/2.;
   G4double TubeLower62_y = (Origin6_y + Aperture62_y - Aperture_Depth/2.*sin(Aperture62_theta)*cos(Aperture62_phi))/2.;
   G4double TubeLower62_z = (Origin6_z + Aperture62_z - Aperture_Depth/2.*cos(Aperture62_theta))/2.;

   G4double TubeLower62_Length = pow(pow(Origin6_x-TubeLower62_x,2.)+pow(Origin6_y-TubeLower62_y,2.)+pow(Origin6_z-TubeLower62_z,2.),0.5)*2.;

   G4Tubs* TubeLower62_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower62_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower62_log = new G4LogicalVolume(TubeLower62_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower62_phys = new G4PVPlacement(Aperture62_Rot,G4ThreeVector(TubeLower62_x,TubeLower62_y,TubeLower62_z),TubeLower62_log,"TubeLower62",experimentalHall_log,false,0);

   TubeLower62_log->SetVisAttributes(TubeLowerVisAtt);

   //------------------------------ Row 7 (phi = 80*deg)

   G4double Origin7_x = 0.;
   G4double Origin7_y = 0.;
   G4double Origin7_z = 100.*mm;

   //----------------0
   G4RotationMatrix* Aperture70_Rot = new G4RotationMatrix();
   G4double Aperture70_theta = 65.*deg;
   G4double Aperture70_phi = 80.*deg;
   Aperture70_Rot->rotateZ(Aperture70_phi);//phi
   Aperture70_Rot->rotateX(Aperture70_theta);//theta

   G4double Aperture70_x = 54.969*mm;
   G4double Aperture70_y = 9.693*mm;
   G4double Aperture70_z = 126.028*mm;

   G4ThreeVector Vect70(Aperture70_x,Aperture70_y,Aperture70_z);

//   G4PVPlacement* Aperture70_phys = new G4PVPlacement(Aperture70_Rot,Vect70,Aperture_log,"Aperture70",experimentalHall_log,false,0);

   G4double TubeUpper70_x = (Aperture70_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture70_theta)*sin(Aperture70_phi))*mm;
   G4double TubeUpper70_y = (Aperture70_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture70_theta)*cos(Aperture70_phi))*mm;
   G4double TubeUpper70_z = (Aperture70_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture70_theta))*mm;

   G4ThreeVector TubeVect70(TubeUpper70_x,TubeUpper70_y,TubeUpper70_z);

//   G4PVPlacement* TubeUpper70_phys = new G4PVPlacement(Aperture70_Rot,TubeVect70,TubeUpper_log,"TubeUpper70",experimentalHall_log,false,0);

   G4double TubeLower70_x = (Origin7_x + Aperture70_x - Aperture_Depth/2.*sin(Aperture70_theta)*sin(Aperture70_phi))/2.;
   G4double TubeLower70_y = (Origin7_y + Aperture70_y - Aperture_Depth/2.*sin(Aperture70_theta)*cos(Aperture70_phi))/2.;
   G4double TubeLower70_z = (Origin7_z + Aperture70_z - Aperture_Depth/2.*cos(Aperture70_theta))/2.;

   G4double TubeLower70_Length = pow(pow(Origin7_x-TubeLower70_x,2.)+pow(Origin7_y-TubeLower70_y,2.)+pow(Origin7_z-TubeLower70_z,2.),0.5)*2.;

   G4Tubs* TubeLower70_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower70_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower70_log = new G4LogicalVolume(TubeLower70_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower70_phys = new G4PVPlacement(Aperture70_Rot,G4ThreeVector(TubeLower70_x,TubeLower70_y,TubeLower70_z),TubeLower70_log,"TubeLower70",experimentalHall_log,false,0);

   TubeLower70_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------1
   G4RotationMatrix* Aperture71_Rot = new G4RotationMatrix();
   G4double Aperture71_theta = 45.*deg;
   G4double Aperture71_phi = 80.*deg;
   Aperture71_Rot->rotateZ(Aperture71_phi);//phi
   Aperture71_Rot->rotateX(Aperture71_theta);//theta

   G4double Aperture71_x = 42.887*mm;
   G4double Aperture71_y = 7.562*mm;
   G4double Aperture71_z = 143.549*mm;

   G4ThreeVector Vect71(Aperture71_x,Aperture71_y,Aperture71_z);

//   G4PVPlacement* Aperture71_phys = new G4PVPlacement(Aperture71_Rot,Vect71,Aperture_log,"Aperture71",experimentalHall_log,false,0);

   G4double TubeUpper71_x = (Aperture71_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture71_theta)*sin(Aperture71_phi))*mm;
   G4double TubeUpper71_y = (Aperture71_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture71_theta)*cos(Aperture71_phi))*mm;
   G4double TubeUpper71_z = (Aperture71_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture71_theta))*mm;

   G4ThreeVector TubeVect71(TubeUpper71_x,TubeUpper71_y,TubeUpper71_z);

//   G4PVPlacement* TubeUpper71_phys = new G4PVPlacement(Aperture71_Rot,TubeVect71,TubeUpper_log,"TubeUpper71",experimentalHall_log,false,0);

   G4double TubeLower71_x = (Origin7_x + Aperture71_x - Aperture_Depth/2.*sin(Aperture71_theta)*sin(Aperture71_phi))/2.;
   G4double TubeLower71_y = (Origin7_y + Aperture71_y - Aperture_Depth/2.*sin(Aperture71_theta)*cos(Aperture71_phi))/2.;
   G4double TubeLower71_z = (Origin7_z + Aperture71_z - Aperture_Depth/2.*cos(Aperture71_theta))/2.;

   G4double TubeLower71_Length = pow(pow(Origin7_x-TubeLower71_x,2.)+pow(Origin7_y-TubeLower71_y,2.)+pow(Origin7_z-TubeLower71_z,2.),0.5)*2.;

   G4Tubs* TubeLower71_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower71_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower71_log = new G4LogicalVolume(TubeLower71_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower71_phys = new G4PVPlacement(Aperture71_Rot,G4ThreeVector(TubeLower71_x,TubeLower71_y,TubeLower71_z),TubeLower71_log,"TubeLower71",experimentalHall_log,false,0);

   TubeLower71_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------2
   G4RotationMatrix* Aperture72_Rot = new G4RotationMatrix();
   G4double Aperture72_theta = 30.*deg;
   G4double Aperture72_phi = 80.*deg;
   Aperture72_Rot->rotateZ(Aperture72_phi);//phi
   Aperture72_Rot->rotateX(Aperture72_theta);//theta

   G4double Aperture72_x = 30.326*mm;
   G4double Aperture72_y = 5.347*mm;
   G4double Aperture72_z = 153.336*mm;

   G4ThreeVector Vect72(Aperture72_x,Aperture72_y,Aperture72_z);

//   G4PVPlacement* Aperture72_phys = new G4PVPlacement(Aperture72_Rot,Vect72,Aperture_log,"Aperture72",experimentalHall_log,false,0);

   G4double TubeUpper72_x = (Aperture72_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture72_theta)*sin(Aperture72_phi))*mm;
   G4double TubeUpper72_y = (Aperture72_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture72_theta)*cos(Aperture72_phi))*mm;
   G4double TubeUpper72_z = (Aperture72_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture72_theta))*mm;

   G4ThreeVector TubeVect72(TubeUpper72_x,TubeUpper72_y,TubeUpper72_z);

//   G4PVPlacement* TubeUpper72_phys = new G4PVPlacement(Aperture72_Rot,TubeVect72,TubeUpper_log,"TubeUpper72",experimentalHall_log,false,0);

   G4double TubeLower72_x = (Origin7_x + Aperture72_x - Aperture_Depth/2.*sin(Aperture72_theta)*sin(Aperture72_phi))/2.;
   G4double TubeLower72_y = (Origin7_y + Aperture72_y - Aperture_Depth/2.*sin(Aperture72_theta)*cos(Aperture72_phi))/2.;
   G4double TubeLower72_z = (Origin7_z + Aperture72_z - Aperture_Depth/2.*cos(Aperture72_theta))/2.;

   G4double TubeLower72_Length = pow(pow(Origin7_x-TubeLower72_x,2.)+pow(Origin7_y-TubeLower72_y,2.)+pow(Origin7_z-TubeLower72_z,2.),0.5)*2.;

   G4Tubs* TubeLower72_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower72_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower72_log = new G4LogicalVolume(TubeLower72_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower72_phys = new G4PVPlacement(Aperture72_Rot,G4ThreeVector(TubeLower72_x,TubeLower72_y,TubeLower72_z),TubeLower72_log,"TubeLower72",experimentalHall_log,false,0);

   TubeLower72_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------3
   G4RotationMatrix* Aperture73_Rot = new G4RotationMatrix();
   G4double Aperture73_theta = 20.*deg;
   G4double Aperture73_phi = 80.*deg;
   Aperture73_Rot->rotateZ(Aperture73_phi);//phi
   Aperture73_Rot->rotateX(Aperture73_theta);//theta

   G4double Aperture73_x = 20.744*mm;
   G4double Aperture73_y = 3.658*mm;
   G4double Aperture73_z = 157.873*mm;

   G4ThreeVector Vect73(Aperture73_x,Aperture73_y,Aperture73_z);

//   G4PVPlacement* Aperture73_phys = new G4PVPlacement(Aperture73_Rot,Vect73,Aperture_log,"Aperture73",experimentalHall_log,false,0);

   G4double TubeUpper73_x = (Aperture73_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture73_theta)*sin(Aperture73_phi))*mm;
   G4double TubeUpper73_y = (Aperture73_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture73_theta)*cos(Aperture73_phi))*mm;
   G4double TubeUpper73_z = (Aperture73_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture73_theta))*mm;

   G4ThreeVector TubeVect73(TubeUpper73_x,TubeUpper73_y,TubeUpper73_z);

//   G4PVPlacement* TubeUpper73_phys = new G4PVPlacement(Aperture73_Rot,TubeVect73,TubeUpper_log,"TubeUpper73",experimentalHall_log,false,0);

   G4double TubeLower73_x = (Origin7_x + Aperture73_x - Aperture_Depth/2.*sin(Aperture73_theta)*sin(Aperture73_phi))/2.;
   G4double TubeLower73_y = (Origin7_y + Aperture73_y - Aperture_Depth/2.*sin(Aperture73_theta)*cos(Aperture73_phi))/2.;
   G4double TubeLower73_z = (Origin7_z + Aperture73_z - Aperture_Depth/2.*cos(Aperture73_theta))/2.;

   G4double TubeLower73_Length = pow(pow(Origin7_x-TubeLower73_x,2.)+pow(Origin7_y-TubeLower73_y,2.)+pow(Origin7_z-TubeLower73_z,2.),0.5)*2.;

   G4Tubs* TubeLower73_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower73_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower73_log = new G4LogicalVolume(TubeLower73_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

//   G4PVPlacement* TubeLower73_phys = new G4PVPlacement(Aperture73_Rot,G4ThreeVector(TubeLower73_x,TubeLower73_y,TubeLower73_z),TubeLower73_log,"TubeLower73",experimentalHall_log,false,0);

   TubeLower73_log->SetVisAttributes(TubeLowerVisAtt);

   //------------------------------ Row 8 (phi = 40*deg)

   G4double Origin8_x = 0.;
   G4double Origin8_y = 0.;
   G4double Origin8_z = 200.*mm;

   //----------------0
   G4RotationMatrix* Aperture80_Rot = new G4RotationMatrix();
   G4double Aperture80_theta = 90.*deg;
   G4double Aperture80_phi = 40.*deg;
   Aperture80_Rot->rotateZ(Aperture80_phi);//phi
   Aperture80_Rot->rotateX(Aperture80_theta);//theta

   G4double Aperture80_x = 39.909*mm;
   G4double Aperture80_y = 47.562*mm;
   G4double Aperture80_z = 200.*mm;

   G4ThreeVector Vect80(Aperture80_x,Aperture80_y,Aperture80_z);

   G4PVPlacement* Aperture80_phys = new G4PVPlacement(Aperture80_Rot,Vect80,Aperture_log,"Aperture80",experimentalHall_log,false,0);

   G4double TubeUpper80_x = (Aperture80_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture80_theta)*sin(Aperture80_phi))*mm;
   G4double TubeUpper80_y = (Aperture80_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture80_theta)*cos(Aperture80_phi))*mm;
   G4double TubeUpper80_z = (Aperture80_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture80_theta))*mm;

   G4ThreeVector TubeVect80(TubeUpper80_x,TubeUpper80_y,TubeUpper80_z);

   G4PVPlacement* TubeUpper80_phys = new G4PVPlacement(Aperture80_Rot,TubeVect80,TubeUpper_log,"TubeUpper80",experimentalHall_log,false,0);

   G4double TubeLower80_x = (Origin8_x + Aperture80_x - Aperture_Depth/2.*sin(Aperture80_theta)*sin(Aperture80_phi))/2.;
   G4double TubeLower80_y = (Origin8_y + Aperture80_y - Aperture_Depth/2.*sin(Aperture80_theta)*cos(Aperture80_phi))/2.;
   G4double TubeLower80_z = (Origin8_z + Aperture80_z - Aperture_Depth/2.*cos(Aperture80_theta))/2.;

   G4double TubeLower80_Length = pow(pow(Origin8_x-TubeLower80_x,2.)+pow(Origin8_y-TubeLower80_y,2.)+pow(Origin8_z-TubeLower80_z,2.),0.5)*2.;

   G4Tubs* TubeLower80_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower80_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower80_log = new G4LogicalVolume(TubeLower80_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

   G4PVPlacement* TubeLower80_phys = new G4PVPlacement(Aperture80_Rot,G4ThreeVector(TubeLower80_x,TubeLower80_y,TubeLower80_z),TubeLower80_log,"TubeLower80",experimentalHall_log,false,0);

   TubeLower80_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------1
   G4RotationMatrix* Aperture81_Rot = new G4RotationMatrix();
   G4double Aperture81_theta = 60.*deg;
   G4double Aperture81_phi = 40.*deg;
   Aperture81_Rot->rotateZ(Aperture81_phi);//phi
   Aperture81_Rot->rotateX(Aperture81_theta);//theta

   G4double Aperture81_x = 34.284*mm;
   G4double Aperture81_y = 40.858*mm;
   G4double Aperture81_z = 230.794*mm;

   G4ThreeVector Vect81(Aperture81_x,Aperture81_y,Aperture81_z);

   G4PVPlacement* Aperture81_phys = new G4PVPlacement(Aperture81_Rot,Vect81,Aperture_log,"Aperture81",experimentalHall_log,false,0);

   G4double TubeUpper81_x = (Aperture81_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture81_theta)*sin(Aperture81_phi))*mm;
   G4double TubeUpper81_y = (Aperture81_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture81_theta)*cos(Aperture81_phi))*mm;
   G4double TubeUpper81_z = (Aperture81_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture81_theta))*mm;

   G4ThreeVector TubeVect81(TubeUpper81_x,TubeUpper81_y,TubeUpper81_z);

   G4PVPlacement* TubeUpper81_phys = new G4PVPlacement(Aperture81_Rot,TubeVect81,TubeUpper_log,"TubeUpper81",experimentalHall_log,false,0);

   G4double TubeLower81_x = (Origin8_x + Aperture81_x - Aperture_Depth/2.*sin(Aperture81_theta)*sin(Aperture81_phi))/2.;
   G4double TubeLower81_y = (Origin8_y + Aperture81_y - Aperture_Depth/2.*sin(Aperture81_theta)*cos(Aperture81_phi))/2.;
   G4double TubeLower81_z = (Origin8_z + Aperture81_z - Aperture_Depth/2.*cos(Aperture81_theta))/2.;

   G4double TubeLower81_Length = pow(pow(Origin8_x-TubeLower81_x,2.)+pow(Origin8_y-TubeLower81_y,2.)+pow(Origin8_z-TubeLower81_z,2.),0.5)*2.;

   G4Tubs* TubeLower81_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower81_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower81_log = new G4LogicalVolume(TubeLower81_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

   G4PVPlacement* TubeLower81_phys = new G4PVPlacement(Aperture81_Rot,G4ThreeVector(TubeLower81_x,TubeLower81_y,TubeLower81_z),TubeLower81_log,"TubeLower81",experimentalHall_log,false,0);

   TubeLower81_log->SetVisAttributes(TubeLowerVisAtt);


   //----------------2
   G4RotationMatrix* Aperture82_Rot = new G4RotationMatrix();
   G4double Aperture82_theta = 40.*deg;
   G4double Aperture82_phi = 40.*deg;
   Aperture82_Rot->rotateZ(Aperture82_phi);//phi
   Aperture82_Rot->rotateX(Aperture82_theta);//theta

   G4double Aperture82_x = 25.446*mm;
   G4double Aperture82_y = 30.326*mm;
   G4double Aperture82_z = 247.179*mm;

   G4ThreeVector Vect82(Aperture82_x,Aperture82_y,Aperture82_z);

   G4PVPlacement* Aperture82_phys = new G4PVPlacement(Aperture82_Rot,Vect82,Aperture_log,"Aperture82",experimentalHall_log,false,0);

   G4double TubeUpper82_x = (Aperture82_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture82_theta)*sin(Aperture82_phi))*mm;
   G4double TubeUpper82_y = (Aperture82_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture82_theta)*cos(Aperture82_phi))*mm;
   G4double TubeUpper82_z = (Aperture82_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture82_theta))*mm;

   G4ThreeVector TubeVect82(TubeUpper82_x,TubeUpper82_y,TubeUpper82_z);

   G4PVPlacement* TubeUpper82_phys = new G4PVPlacement(Aperture82_Rot,TubeVect82,TubeUpper_log,"TubeUpper82",experimentalHall_log,false,0);

   G4double TubeLower82_x = (Origin8_x + Aperture82_x - Aperture_Depth/2.*sin(Aperture82_theta)*sin(Aperture82_phi))/2.;
   G4double TubeLower82_y = (Origin8_y + Aperture82_y - Aperture_Depth/2.*sin(Aperture82_theta)*cos(Aperture82_phi))/2.;
   G4double TubeLower82_z = (Origin8_z + Aperture82_z - Aperture_Depth/2.*cos(Aperture82_theta))/2.;

   G4double TubeLower82_Length = pow(pow(Origin8_x-TubeLower82_x,2.)+pow(Origin8_y-TubeLower82_y,2.)+pow(Origin8_z-TubeLower82_z,2.),0.5)*2.;

   G4Tubs* TubeLower82_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower82_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower82_log = new G4LogicalVolume(TubeLower82_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

   G4PVPlacement* TubeLower82_phys = new G4PVPlacement(Aperture82_Rot,G4ThreeVector(TubeLower82_x,TubeLower82_y,TubeLower82_z),TubeLower82_log,"TubeLower82",experimentalHall_log,false,0);

   TubeLower82_log->SetVisAttributes(TubeLowerVisAtt);

   //----------------3
   G4RotationMatrix* Aperture83_Rot = new G4RotationMatrix();
   G4double Aperture83_theta = 25.*deg;
   G4double Aperture83_phi = 40.*deg;
   Aperture83_Rot->rotateZ(Aperture83_phi);//phi
   Aperture83_Rot->rotateX(Aperture83_theta);//theta

   G4double Aperture83_x = 16.730*mm;
   G4double Aperture83_y = 19.939*mm;
   G4double Aperture83_z = 255.817*mm;

   G4ThreeVector Vect83(Aperture83_x,Aperture83_y,Aperture83_z);

   G4PVPlacement* Aperture83_phys = new G4PVPlacement(Aperture83_Rot,Vect83,Aperture_log,"Aperture83",experimentalHall_log,false,0);

   G4double TubeUpper83_x = (Aperture83_x + (Aperture_Depth+Tube_Length)/2.*sin(Aperture83_theta)*sin(Aperture83_phi))*mm;
   G4double TubeUpper83_y = (Aperture83_y + (Aperture_Depth+Tube_Length)/2.*sin(Aperture83_theta)*cos(Aperture83_phi))*mm;
   G4double TubeUpper83_z = (Aperture83_z + (Aperture_Depth+Tube_Length)/2.*cos(Aperture83_theta))*mm;

   G4ThreeVector TubeVect83(TubeUpper83_x,TubeUpper83_y,TubeUpper83_z);

   G4PVPlacement* TubeUpper83_phys = new G4PVPlacement(Aperture83_Rot,TubeVect83,TubeUpper_log,"TubeUpper83",experimentalHall_log,false,0);

   G4double TubeLower83_x = (Origin8_x + Aperture83_x - Aperture_Depth/2.*sin(Aperture83_theta)*sin(Aperture83_phi))/2.;
   G4double TubeLower83_y = (Origin8_y + Aperture83_y - Aperture_Depth/2.*sin(Aperture83_theta)*cos(Aperture83_phi))/2.;
   G4double TubeLower83_z = (Origin8_z + Aperture83_z - Aperture_Depth/2.*cos(Aperture83_theta))/2.;

   G4double TubeLower83_Length = pow(pow(Origin8_x-TubeLower83_x,2.)+pow(Origin8_y-TubeLower83_y,2.)+pow(Origin8_z-TubeLower83_z,2.),0.5)*2.;

   G4Tubs* TubeLower83_Cyl = new G4Tubs("TubeLower_Cyl",0.,TubeLower_Diam/2.,TubeLower83_Length/2.,0.,360.*deg);
   G4LogicalVolume* TubeLower83_log = new G4LogicalVolume(TubeLower83_Cyl,Vacuum,"TubeLower_Cyl",0,0,0);

   G4PVPlacement* TubeLower83_phys = new G4PVPlacement(Aperture83_Rot,G4ThreeVector(TubeLower83_x,TubeLower83_y,TubeLower83_z),TubeLower83_log,"TubeLower83",experimentalHall_log,false,0);

   TubeLower83_log->SetVisAttributes(TubeLowerVisAtt);

   //------------------------------------------------------------------

  return experimentalHall_phys;
}

